From: Balint Reczey <balint.reczey@canonical.com>
Date: Wed, 16 Oct 2019 11:40:51 +0200
Subject: Fix empty ~/.config/wslu/baseexec

Previous versions of wslu could create an empty file and this is not
a valid configuration.
---
 src/wslu-header | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/wslu-header b/src/wslu-header
index da17420..6f893c6 100644
--- a/src/wslu-header
+++ b/src/wslu-header
@@ -112,7 +112,7 @@ if [ ! -f ~/.config/wslu/oemcp ]; then
 	"$(interop_prefix)"c/Windows/System32/reg.exe query "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CodePage" /v OEMCP 2>&1 | sed -n 3p | sed -e 's|\r||g' | grep -o '[[:digit:]]*' > ~/.config/wslu/oemcp
 fi
 
-if [ ! -f ~/.config/wslu/baseexec ]; then
+if [ ! -f ~/.config/wslu/baseexec ] || [ -z "$(cat ~/.config/wslu/baseexec)" ]; then
 	wslutmpbuild=$(reg.exe query "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion" /v CurrentBuild | tail -n 2 | head -n 1 | sed -e 's|\r||g')
 	wslutmpbuild=${wslutmpbuild##* }
 	wslutmpbuild="$(( $wslutmpbuild + 0 ))"
